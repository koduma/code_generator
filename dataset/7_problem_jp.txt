0, 1, ? のみからなる文字列 S があります。この文字列を K 個連結したものを T とします。
この文字列の ? を全て 0 か 1 に置き換えた文字列は、S の中に含まれる ? の数を q 個とすると、全部で 2^Kq通り考えられますが、その全てについて以下の問題を解いて、
その答えの和を (10^9+7) で割った余りを求めてください。

? を置き換えた後の文字列を T′とします。
T′に以下の操作を繰り返し行うことで全ての文字を同じにするとき、必要な最小の操作回数は何回ですか？

1≤l≤r≤∣T′∣となる整数 l,r を選ぶ。そして、T′の l 文字目から r 文字目(両端含む)までの各文字を、0 であれば 1 に、1 であれば 0 に変更する。